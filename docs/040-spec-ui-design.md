# ときのきせき — UI設計仕様書

> この文書は VISION.md の設計原則を、具体的なUI構造・画面設計に落とし込んだものである。
> 実装時は VISION.md と合わせて参照すること。

---

## 1. 設計の核心：「2つの空間」モデル

### 現状の問題

現在のUIは「タイムライン」が発見・整理・閲覧のすべてを担っている。
タグやできごとで整理しても、それを味わう場所がタイムライン内のフィルタでしかなく、「整理した先にあるご褒美」が体験として存在しない。

### 解決：入力と出力を分離する

アプリを **3つの空間** に分ける。

| 空間 | 役割 | 比喩 |
|------|------|------|
| **ホーム** | 現在地の確認。アルバムの成長を感じる | 玄関 |
| **タイムライン** | 記録の川を眺める。発見し、触れる（入力） | 川辺 |
| **ギャラリー** | 記憶の棚。小さな行動の成果が形になる（出力） | 自分だけの展示室 |

**最も重要な原則**：タイムラインでの小さな行動（ベスト選び、タグ付け、できごと作成）が、ギャラリーに自然と蓄積される。ユーザーがギャラリーを開くたびに「あ、こんなに溜まってたんだ」と嬉しくなる。これが「触れるだけで前に進む」の体験である。

---

## 2. ナビゲーション構造

### グローバルナビゲーション

アプリ下部またはサイドに常駐するタブナビゲーション。3つの空間を自由に行き来できる。

```
[ 🏠 ホーム ]  [ 🌊 タイムライン ]  [ 🖼️ ギャラリー ]
```

- どのタブからでも他のタブに移動可能
- 現在のタブはアクセントカラーでハイライト
- タイムラインとギャラリーの間に上下関係はない（並列）

### 画面遷移の全体像

```
ホーム
├── → タイムライン（「タイムラインを開く」）
├── → ギャラリー（できごと・タグをタップ）
└── → フォルダ設定

タイムライン
├── → 日付詳細（日付カードをタップ → 写真一覧）
│   ├── ベスト選び（★をタップ）
│   ├── タグ付け（タグボタン）
│   └── スライドショー（この日のスライドショー）
├── → できごと作成（サジェスト or 手動）
└── → 自動タグ付け設定

ギャラリー
├── → できごと詳細（できごとカードをタップ）
│   ├── 写真一覧
│   ├── ベストのみ表示
│   └── スライドショー
├── → タグ詳細（タグチップをタップ → 該当写真一覧）
│   └── スライドショー
└── → ベストコレクション（全ベスト → スライドショー）
```

---

## 3. 各画面の詳細設計

### 3.1 ホーム画面

**目的**：アルバムの成長を実感する。今日やれることを軽く提案する。

#### 構成要素

**ウェルカムエリア**
- アプリ名「ときのきせき」
- 温かい挨拶（「おかえりなさい」等）
- サブコピー（「あなたのアルバムは少しずつ育っています」等）

**サマリーカード**（横並び3つ）
- ✨ N枚の記憶（ベスト選びした写真の総数）
- 📅 Nつのできごと（作成したできごとの総数）
- 🏷️ Nのタグ（タグの種類数）
- これらの数字は、ユーザーの行動によって自然に増えていく。増えたことが可視化されることで「触れるだけで前に進む」を体感できる。

**今日の提案カード**（省略可能）
- 未整理の月を提案：「2021年7月の写真がまだ整理されていません。眺めてみませんか？」
- 最近の写真リマインド：「3年前の今日、こんな写真を撮っていました」
- あくまで提案。無視しても何も起きない。「歩幅を強制しない」を守る。

**最近のできごと**（リスト）
- 直近に作成・更新されたできごとを2〜3件表示
- タップするとギャラリーのできごと詳細へ遷移

**フォルダ管理**
- 登録済みフォルダの一覧（現在のホーム画面の機能を引き継ぐ）
- ただし、パスの生表示はせず、フォルダ名とサムネイルで表現する
- フォルダ追加ボタン
- 再スキャンは目立たない位置（設定内 or セカンダリボタン）に移動

#### 設計上の注意
- ホーム画面はアプリを開いたときの「第一印象」。温かさと安心感を最優先
- 技術的な情報（パス、スキャン状態等）は極力隠す
- サマリーの数字がゼロの場合も否定的にならない表現を使う（例：「まだ記憶はありません。タイムラインから始めましょう」）

---

### 3.2 タイムライン画面

**目的**：記録の川を眺める。気になったものに触れる（＝入力の場）。

#### 構成要素

**ヘッダー**
- 「← 戻る」は不要（タブナビゲーションで代替）
- 画面タイトル：「タイムライン」
- 右端：機能ボタン群

**機能ボタンの整理**（現状5つ → 優先度をつける）

| ボタン | 優先度 | 表示方法 |
|--------|--------|----------|
| ▶ スライドショー | 高 | 常時表示（アクセントカラー） |
| タグ付け | 中 | 通常表示 |
| できごと / +できごと | 中 | ひとつに統合。「できごと」ボタン1つで管理と作成の両方にアクセス |
| タグ検索 | 低 | アイコンのみ or メニュー内 |

**日付カードリスト**（メインコンテンツ）
- 現在の構造を維持（サムネイル + 日付 + 枚数）
- 追加：カードにタグ・ベストの有無を小さく表示（「タグ済」バッジ、⭐マーク）
- これにより、タイムライン上で「どこまで触れたか」が一目でわかる

**できごとサジェスト**（現状の機能を改良）
- 現在の「できごとですか？」UIを維持
- 改良点：「いいえ」の代わりに **「あとで」** を使う
  - 「いいえ」= 永久に無視（ユーザーは判断を迫られる）
  - 「あとで」= 今は決めなくていい（歩幅を強制しない）
- 「調整」は残す（大きな歩幅を選びたい人のため）

**年ナビゲーション**（右端のスクロールインジケーター）
- 現在の実装を維持

#### 日付詳細画面（日付カードをタップした先）

- その日の写真一覧（グリッド表示）
- 各写真に対して：
  - ⭐ ベスト選択/解除（タップのみ）
  - タグ追加（チップUI）
  - フルスクリーン表示
- この日のスライドショー再生ボタン

---

### 3.3 ギャラリー画面

**目的**：記憶の棚。タイムラインでの行動が蓄積された成果を見る場所（＝出力の場）。

#### 構成要素

**セクション1：できごと**
- 作成済みのできごとをカード形式で一覧表示
- 各カードに表示する情報：
  - できごとタイトル
  - 期間（日付範囲）
  - 写真枚数・ベスト枚数
  - 代表サムネイル（カバー画像）
- タップ → できごと詳細画面へ

**セクション2：タグ**
- タグ付け済みのタグをチップ（ピル型）で一覧表示
- 各チップに表示する情報：
  - タグ名
  - 枚数
  - 背景色（タグごとに自動 or 手動で色分け）
- タップ → タグ詳細画面（そのタグがついた写真一覧 + スライドショーボタン）

**セクション3：ベストコレクション**
- ユーザーが⭐をつけた写真の総コレクション
- 全ベストの枚数を表示
- スライドショーボタン（ベストだけのスライドショー）
- タップ → ベスト写真一覧

**ギャラリーが空の場合**
- 否定的にならない表現を使う
- 例：「まだ記憶はありません。タイムラインを眺めて、気になった写真にベストをつけてみましょう ✨」
- タイムラインへの導線ボタンを配置

#### できごと詳細画面

- できごとタイトル（編集可能）
- 期間・枚数
- 含まれる日付の一覧（日付カード形式）
- 写真グリッド表示
- フィルター：全写真 / ベストのみ
- スライドショーボタン
- できごと編集（日付の追加・削除、タイトル変更）
- できごと削除

---

## 4. ビジュアルデザイン方針

### 4.1 カラーパレット

現在のダークネイビー基調から、**ウォーム＆ライト基調**に変更する。
VISION.md の設計原則4「明るく、温かく」に準拠。

```
背景（メイン）：  #FFF8F0（温かいオフホワイト）
背景（グラデ）：  #FFF8F0 → #FFF5EB → #FAFAFA
カード背景：      rgba(255,255,255,0.85)
カードボーダー：  rgba(0,0,0,0.06)

アクセント：      #FF7043（温かいオレンジレッド）
アクセント薄：    rgba(255,112,67,0.15)

タグ系：          #C8E6C0 / #A8C5A0（セージグリーン）
できごと系：      #BBDEFB / #90CAF9（スカイブルー）
ベスト系：        #FFECB3 / #FFF8E1（ゴールド）

テキスト（黒）：  #3E2723
テキスト（中）：  #5D4037
テキスト（薄）：  #8D6E63
テキスト（淡）：  #BCAAA4
```

#### ダークモード対応について

写真ビューアーとしてダークモードのニーズもある。将来的にダーク/ライトの切り替えを検討してもよいが、**まずはライトモードをデフォルトとして実装する**。ビジョンの「明るく温かく」を基本体験として確立することが優先。

### 4.2 タイポグラフィ

- 日本語フォント：Noto Sans JP（ウェイト: 400, 500, 600, 700, 800）
- 英数字：Noto Sans JP に含まれるものを使用（追加フォント不要）
- アプリタイトル「ときのきせき」：アクセントカラー、太字

### 4.3 コンポーネント共通ルール

**角丸**
- カード：14px
- ボタン（大）：20px（ピル型）
- ボタン（小）：12px
- チップ/タグ：20px（完全ピル型）
- モーダル：16px

**シャドウ**
- カード：`0 2px 8px rgba(0,0,0,0.04)`（控えめ）
- モーダル：`0 8px 32px rgba(0,0,0,0.12)`

**アニメーション**
- 画面遷移：フェード or スライド、200-300ms
- ボタンホバー/プレス：transform scale(0.98)、150ms
- カードホバー：わずかなリフト（translateY(-2px)）

---

## 5. 自動タグ付けダイアログの改善

### 現状の問題

技術用語（CLIP、YOLO、閾値）がユーザーに露出しており、ビジョンのユーザー像（整理が苦手な人）にとって敷居が高い。

### 改善方針

技術的な仕組みを隠し、**結果で説明する**UIに変更する。

#### 改善後のUI構成

```
自動タグ付け

写真の向きを自動で直す                    [ON/OFF]
  EXIF情報がない写真の向きを自動判定します

写っているものを見つける                  [ON/OFF]
  人物・動物・食べ物・乗り物などを自動検出します
  [精度スライダー: あいまい ←→ 厳密]

シーンを分類する                          [ON/OFF]
  屋外・屋内・夜景・パーティーなどを自動判定します
  [検出したいシーンのチェックリスト]
    ☑ 屋外　☑ 屋内　☑ パーティー　☑ 夜景
    ☑ 夕焼け　☑ 風景　☑ 食事　...

                        [キャンセル] [タグ付け開始]
```

#### 変更ポイント

| 現在 | 改善後 |
|------|--------|
| 回転補正 (CLIP) | 写真の向きを自動で直す |
| 物体検出 (YOLO) | 写っているものを見つける |
| シーン分類 (CLIP) | シーンを分類する |
| 閾値: 60% | 精度: あいまい ←→ 厳密 |
| ハトマスク（英語プロンプト表示） | シーン名のみ日本語表示（英語プロンプトは非表示） |

---

## 6. 用語の統一

アプリ内で使用する用語を統一する。

| 概念 | アプリ内の用語 | 使わない表現 |
|------|---------------|-------------|
| ユーザーが気に入った写真 | ベスト / ⭐ | お気に入り、Like |
| 日付をまとめた単位 | できごと | イベント、アルバム |
| 写真につける自由ラベル | タグ | カテゴリ、ラベル |
| ベスト・タグ・できごとの成果物 | ギャラリー | コレクション、ライブラリ |
| 時系列の写真一覧 | タイムライン | フィード、一覧 |
| 写真のソースフォルダ | フォルダ | ソース、ディレクトリ |

---

## 7. 移行方針：現UIから新UIへ

### 段階的に移行する

一度にすべてを変更するのではなく、段階的に進める。

#### Phase 1：構造変更（ナビゲーション + 3画面）
- タブナビゲーション導入（ホーム / タイムライン / ギャラリー）
- ホーム画面の新設（現在のホーム画面のフォルダ管理 + サマリー）
- ギャラリー画面の新設（できごと一覧 + タグ一覧 + ベストコレクション）
- タイムライン画面は現在の機能をほぼそのまま移行
- **この段階ではダークテーマのままでもよい**（構造の正しさを先に検証）

#### Phase 2：ビジュアル変更（ライトテーマ + トーン）
- カラーパレットをウォームライトに変更
- コンポーネントの角丸・シャドウ調整
- 自動タグ付けダイアログの用語改善

#### Phase 3：体験の磨き込み
- ホーム画面の「今日の提案」ロジック
- サマリー数値のアニメーション
- 空状態の丁寧なメッセージ
- できごとサジェストの「あとで」ボタン追加

---

## 8. 実装上の注意

### データの流れ

ギャラリー画面は新しいデータを生成しない。すべてタイムラインで行われたアクションの**集約ビュー**である。

```
[タイムライン] ← ユーザーの行動 → [既存データ（ベスト、タグ、できごと）]
                                            ↓ 集約
                                    [ギャラリー] ← 閲覧のみ
```

つまり：
- ギャラリーのできごと一覧 = 既存のできごとデータの別表示
- ギャラリーのタグ一覧 = 既存のタグデータの別表示
- ギャラリーのベストコレクション = ベストフラグがついた写真のフィルタ表示

**新しいDBテーブルやデータ構造の追加は不要**。UIレイヤーでの集約表示のみで実現できる。

### ルーティング

```
/                → ホーム
/timeline        → タイムライン
/timeline/:date  → 日付詳細
/gallery         → ギャラリー
/gallery/event/:id    → できごと詳細
/gallery/tag/:name    → タグ詳細
/gallery/best         → ベストコレクション
/slideshow       → スライドショー（パラメータで対象を指定）
/settings        → 設定（フォルダ管理等）
```

### 既存機能の配置変更まとめ

| 既存機能 | 現在の場所 | 新しい場所 |
|----------|-----------|-----------|
| フォルダ登録・管理 | ホーム画面メイン | ホーム画面下部 or 設定画面 |
| タイムライン表示 | タイムライン画面 | タイムライン画面（変更なし） |
| できごと管理モーダル | タイムラインヘッダー | ギャラリー > できごとセクション |
| できごと作成 | タイムラインヘッダー + サジェスト | タイムライン内（サジェスト + 手動） |
| できごと表示（フィルタ） | タイムライン内フィルタ | ギャラリー > できごと詳細 |
| タグ検索 | タイムラインヘッダー | ギャラリー > タグセクション |
| 自動タグ付け | タイムラインヘッダー | タイムラインヘッダー（用語改善のみ） |
| スライドショー | タイムラインヘッダー | 各所にコンテキスト付きで配置 |

---

## 9. 設計チェックリスト

新しい機能や画面を追加する際、以下を確認する。

- [ ] **歩幅を強制していないか？** — その機能は「使わなくてもいい」か？
- [ ] **触れるだけで前に進むか？** — 小さな行動がギャラリーに蓄積されるか？
- [ ] **癒しを最優先にしているか？** — 効率より「ふふっ」を優先しているか？
- [ ] **明るく温かいか？** — UIのトーン、コピー、色が暗くないか？
- [ ] **技術用語を使っていないか？** — ユーザーに見える場所にCLIP/YOLO/閾値等がないか？
- [ ] **否定的な表現を使っていないか？** — 空状態やエラー時のメッセージが温かいか？
